<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" id="meta-description" content="">
    <meta property="og:type" content="website">
    <meta property="og:title" id="og-title" content="Color - Paint">
    <meta property="og:description" id="og-description" content="">
    <title>Color - Paint</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link rel="stylesheet" href="/styles/main.css">
    <script>
        // Atualizar breadcrumb imediatamente da URL para evitar piscar
        (function() {
            function getCategoryFromUrl() {
                const path = window.location.pathname;
                
                // Formato novo: /en/:category/:drawing
                const drawingMatch = path.match(/^\/en\/([^\/]+)\/([^\/]+)/);
                if (drawingMatch) {
                    return decodeURIComponent(drawingMatch[1]);
                }
                
                // Formato novo: /en/:category (categoria única)
                const categoryMatch = path.match(/^\/en\/([^\/]+)$/);
                if (categoryMatch) {
                    return decodeURIComponent(categoryMatch[1]);
                }
                
                // Formato antigo: ?cat=...
                const params = new URLSearchParams(window.location.search);
                return params.get('cat');
            }
            
            function getDrawingFromUrl() {
                const path = window.location.pathname;
                
                // Formato novo: /en/:category/:drawing
                const drawingMatch = path.match(/^\/en\/[^\/]+\/([^\/]+)/);
                if (drawingMatch) {
                    return decodeURIComponent(drawingMatch[1]);
                }
                
                // Formato antigo: ?drawing=...
                const params = new URLSearchParams(window.location.search);
                return params.get('drawing');
            }
            
            function capitalizeWords(str) {
                if (!str) return '';
                return str
                    .toLowerCase()
                    .split(' ')
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(' ');
            }
            
            function removeTrailingNumbers(str) {
                if (!str) return '';
                // Remove espaços/hífens/underscores seguidos de números no final
                return str.replace(/[\s_-]+\d+$/, '');
            }
            
            function slugToFriendlyName(slug) {
                if (!slug) return '';
                // Converter slug (ex: "dog-skating") para nome amigável (ex: "Dog Skating")
                let friendlyName = slug.replace(/-/g, ' ');
                // Remover números ao final
                friendlyName = removeTrailingNumbers(friendlyName);
                return capitalizeWords(friendlyName);
            }
            
            function updatePageElements() {
                const category = getCategoryFromUrl();
                const drawingSlug = getDrawingFromUrl();
                
                if (category) {
                    const categoryFriendlyName = capitalizeWords(category);
                    const breadcrumbCategory = document.getElementById('breadcrumb-category');
                    const breadcrumbCategoryLink = document.getElementById('breadcrumb-category-link');
                    if (breadcrumbCategory && breadcrumbCategoryLink) {
                        breadcrumbCategoryLink.textContent = categoryFriendlyName;
                        breadcrumbCategoryLink.href = `/en/${encodeURIComponent(category.toLowerCase().trim())}`;
                    }
                }
                
                if (drawingSlug) {
                    const drawingFriendlyName = slugToFriendlyName(drawingSlug);
                    
                    // Atualizar breadcrumb
                    const breadcrumbDrawing = document.getElementById('breadcrumb-drawing');
                    if (breadcrumbDrawing) {
                        breadcrumbDrawing.textContent = '';
                        const span = document.createElement('span');
                        span.textContent = drawingFriendlyName;
                        breadcrumbDrawing.appendChild(span);
                    }
                    
                    // Atualizar H1
                    const h1 = document.getElementById('drawing-title');
                    if (h1) {
                        h1.textContent = drawingFriendlyName + ' Coloring Page';
                        h1.style.display = 'block';
                    }
                }
            }
            
            // Executar imediatamente se o DOM já estiver pronto
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', updatePageElements);
            } else {
                updatePageElements();
            }
        })();
    </script>
</head>
<body class="paint-page">
    <div class="paint-container">
        <aside class="color-palette">
            <header>
                <a href="#" id="back-link" class="back-link">← Back</a>
                <nav class="breadcrumb breadcrumb-paint" aria-label="Breadcrumb">
                    <ol>
                        <li><a href="/">Home</a></li>
                        <li id="breadcrumb-category"><a href="#" id="breadcrumb-category-link">Category</a></li>
                        <li id="breadcrumb-drawing" aria-current="page">Drawing</li>
                    </ol>
                </nav>
                <h2>Colors</h2>
            </header>
            <div id="color-grid" class="color-grid">
                <!-- Cores serão carregadas aqui -->
            </div>
        </aside>
        <main class="drawing-area">
            <div class="drawing-header">
                <h1 id="drawing-title" style="display: none;"></h1>
                <a href="javascript:void(0)" id="download-link" class="download-link" title="Download image">⬇ Download</a>
            </div>
            <div id="canvas-container" class="canvas-container">
                <!-- Canvas será criado aqui -->
            </div>
        </main>
    </div>
    <script type="module" src="/js/ui/painter.js"></script>
    <script type="module" src="/js/app.js"></script>
</body>
</html>

